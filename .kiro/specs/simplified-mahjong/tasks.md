# 実装計画

- [x] 1. プロジェクト構造とコア インターフェースの設定





  - Node.js プロジェクトの初期化とディレクトリ構造の作成
  - 基本的な依存関係（Express、Socket.io）のインストール
  - 牌、プレイヤー、ゲームの基本クラス定義
  - _要件: 1.1, 1.2, 1.3_

- [x] 2. 牌システムとデータモデルの実装





- [x] 2.1 牌クラスと牌デッキの実装


  - Tileクラスの作成（索子1-9、白發中）
  - デッキ初期化ロジック（各牌4枚ずつ、計48枚）
  - シャッフル機能の実装
  - _要件: 1.2_



- [x] 2.2 プレイヤークラスの実装





  - Playerクラスの作成（手牌、リーチ状態、捨て牌管理）
  - 手牌操作メソッド（追加、削除、表示）
  - _要件: 2.1, 2.2, 3.2_

- [ ]* 2.3 データモデルの単体テスト
  - 牌クラスのテスト（正しい牌の生成、識別）
  - プレイヤークラスのテスト（手牌操作）
  - _要件: 1.2, 2.1_

- [x] 3. ゲームロジックエンジンの実装





- [x] 3.1 基本ゲームクラスの実装


  - Gameクラスの作成（プレイヤー管理、状態管理）
  - ゲーム初期化（牌配り、先手決定）
  - 手番管理システム
  - _要件: 1.1, 1.3, 2.4_

- [x] 3.2 完成形判定ロジックの実装


  - 順子+対子パターンの判定
  - 刻子+対子パターンの判定
  - テンパイ判定（待ち牌の特定）
  - _要件: 4.1, 4.2_


- [x] 3.3 リーチシステムの実装

  - リーチ宣言の条件チェック（テンパイ状態）
  - リーチ後の自動捨て牌システム
  - リーチ状態の管理
  - _要件: 3.1, 3.2, 3.3, 3.4_

- [ ]* 3.4 ゲームロジックの単体テスト
  - 完成形判定の各パターンテスト
  - テンパイ判定のテスト
  - リーチシステムのテスト
  - _要件: 3.1, 4.1, 4.2_

- [x] 4. サーバーサイドの実装





- [x] 4.1 Express サーバーとSocket.io の設定


  - Express アプリケーションの設定
  - Socket.io サーバーの初期化
  - 静的ファイル配信の設定
  - _要件: 1.1_


- [x] 4.2 ゲーム管理システムの実装

  - ゲームルーム管理（2人プレイヤーのマッチング）
  - プレイヤー接続・切断の処理
  - ゲーム状態の同期システム
  - _要件: 1.1, 5.3_



- [x] 4.3 ゲームアクションハンドラーの更新（自動牌引き対応）


  - 手番開始時の自動牌引き処理の実装
  - 牌を捨てる処理（手動操作のみ）
  - リーチ宣言処理
  - リーチ後の牌捨て制限機能
  - ツモ・ロン判定処理
  - _要件: 2.1, 2.2, 3.3, 3.4, 3.5, 7.1, 7.2, 7.4_

- [x] 4.4 エラーハンドリングと検証の実装





  - 無効な操作の検証
  - エラーメッセージの日本語化
  - 適切なエラーレスポンス
  - _要件: 6.3_

- [x] 5. フロントエンド UI の実装





- [x] 5.1 基本HTML構造とCSS スタイリング


  - ゲーム画面のレイアウト作成
  - 牌の視覚的デザイン
  - レスポンシブデザインの実装
  - _要件: 5.1, 5.2_



- [x] 5.2 牌表示とインタラクションの更新（自動牌引き対応）


  - 手牌の表示システム
  - 捨て牌エリアの表示
  - 牌クリック・選択機能（捨て牌のみ）
  - 「牌を引く」ボタンの削除
  - リーチ後の牌選択制限UI
  - _要件: 5.1, 5.2, 7.3, 7.4_

- [x] 5.3 ゲーム状態表示の実装

  - 現在の手番表示
  - リーチ状態の表示

  - 残り牌数の表示
  - ゲーム終了時の勝者表示
  - _要件: 5.3, 5.4, 5.5, 4.4_

- [x] 5.4 Socket.io クライアント通信の実装

  - サーバーとの WebSocket 接続
  - ゲーム状態の受信と画面更新
  - プレイヤーアクションの送信
  - _要件: 2.1, 2.2, 2.3, 3.1_

- [x] 6. ゲームフロー統合とエッジケース処理





- [x] 6.1 完全なゲームフローの実装


  - ゲーム開始から終了までの流れ
  - プレイヤー間の状態同期
  - 勝利条件の判定と処理
  - _要件: 4.3, 4.4_

- [x] 6.2 エッジケースとエラー処理の実装


  - 流局処理（山が空になった場合）
  - プレイヤー切断時の処理
  - 制限時間の実装
  - 新しいゲーム開始オプション
  - _要件: 6.1, 6.2, 6.4_

- [ ] 7. 自動牌引き機能の統合実装
- [x] 7.1 自動牌引きシステムの実装


  - 手番開始時の自動牌引きロジック
  - ゲームフローの更新（自動牌引き対応）
  - 牌引き後の状態管理
  - _要件: 7.1, 2.1_

- [x] 7.2 リーチ後制限システムの実装


  - リーチ状態での牌捨て制限チェック
  - 引いた牌以外の選択禁止機能
  - エラーハンドリング（無効な牌選択）
  - _要件: 3.5, 7.4_

- [x] 7.3 UIの自動牌引き対応



  - 「牌を引く」ボタンの削除
  - 自動牌引き時の視覚的フィードバック
  - リーチ後の牌選択制限表示
  - _要件: 7.1, 7.3, 7.4_

- [ ]* 7.4 自動牌引き機能のテスト
  - 自動牌引きロジックのテスト
  - リーチ後制限機能のテスト
  - UIインタラクションのテスト
  - _要件: 7.1, 7.2, 7.4_

- [ ]* 6.3 統合テストとデバッグ
  - エンドツーエンドのゲームフローテスト
  - 複数ブラウザでの動作確認
  - エラーケースの動作確認
  - _要件: 全要件_