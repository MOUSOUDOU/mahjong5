<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹ç‰Œè¡¨ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</title>
    <link rel="stylesheet" href="public/styles.css">
    <style>
        .test-container {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
        }

        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .test-controls {
            text-align: center;
            margin: 20px 0;
        }

        .test-btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background: #4caf50;
            color: white;
            cursor: pointer;
            font-size: 14px;
        }

        .test-btn:hover {
            background: #45a049;
        }

        .test-btn.secondary {
            background: #2196f3;
        }

        .test-btn.secondary:hover {
            background: #1976d2;
        }

        .test-btn.danger {
            background: #f44336;
        }

        .test-btn.danger:hover {
            background: #da190b;
        }

        .explanation {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 14px;
            line-height: 1.5;
        }

        .demo-hand {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: nowrap;
            align-items: center;
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            min-height: 90px;
        }

        .status-info {
            background: #fff3e0;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 14px;
            border-left: 4px solid #ff9800;
        }
    </style>
</head>

<body>
    <div class="test-container">
        <h1>æ‰‹ç‰Œè¡¨ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>

        <div class="explanation">
            <h3>ğŸ¯ å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½:</h3>
            <ul>
                <li><strong>ç‰Œã‚’å¼•ã:</strong> å¼•ã„ãŸç‰Œã¯å³ç«¯ã«è¡¨ç¤ºï¼ˆã‚½ãƒ¼ãƒˆã—ãªã„ï¼‰</li>
                <li><strong>ç‰Œã‚’æ¨ã¦ã‚‹:</strong> æ¨ã¦ãŸå¾Œã€æ®‹ã‚Šã®ç‰Œã‚’å†ã‚½ãƒ¼ãƒˆã—ã¦è¡¨ç¤º</li>
                <li><strong>ãƒã‚¦ã‚¹æ“ä½œ:</strong> ã‚·ãƒ³ã‚°ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆé¸æŠï¼‰ã€ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆæ¨ã¦ã‚‹ï¼‰</li>
                <li><strong>è¦–è¦šçš„åŒºåˆ¥:</strong> å¼•ã„ãŸç‰Œã«ã¯åŒºåˆ‡ã‚Šç·šã¨ã€Œå¼•ã€ãƒãƒ¼ã‚¯ã‚’è¡¨ç¤º</li>
                <li><strong>ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–:</strong> ç”»é¢ã‚µã‚¤ã‚ºã«å¿œã˜ã¦é©åˆ‡ã«ã‚¹ã‚±ãƒ¼ãƒ«</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ãƒ†ã‚¹ãƒˆ1: åŸºæœ¬æ‰‹ç‰Œè¡¨ç¤ºï¼ˆ4æšï¼‰</h3>
            <p>ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸåŸºæœ¬æ‰‹ç‰Œã‚’è¡¨ç¤ºã—ã¾ã™</p>

            <div class="demo-hand" id="basic-hand"></div>

            <div class="test-controls">
                <button class="test-btn" onclick="showBasicHand()">åŸºæœ¬æ‰‹ç‰Œè¡¨ç¤º</button>
                <button class="test-btn secondary" onclick="shuffleBasicHand()">ãƒ©ãƒ³ãƒ€ãƒ é †åº</button>
            </div>

            <div class="status-info">
                <strong>çŠ¶æ…‹:</strong> 4æšã®æ‰‹ç‰ŒãŒã‚½ãƒ¼ãƒˆã•ã‚Œã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆç´¢å­1-9 â†’ å­—ç‰Œç™½ç™¼ä¸­ï¼‰
            </div>
        </div>

        <div class="test-section">
            <h3>ãƒ†ã‚¹ãƒˆ2: ç‰Œã‚’å¼•ã„ãŸçŠ¶æ…‹ï¼ˆ5æšï¼‰</h3>
            <p>å¼•ã„ãŸç‰ŒãŒå³ç«¯ã«åˆ†é›¢è¡¨ç¤ºã•ã‚Œã¾ã™</p>

            <div class="demo-hand" id="drawn-hand"></div>

            <div class="test-controls">
                <button class="test-btn" onclick="drawTile()">ç‰Œã‚’å¼•ã</button>
                <button class="test-btn secondary" onclick="drawRandomTile()">ãƒ©ãƒ³ãƒ€ãƒ ç‰Œã‚’å¼•ã</button>
                <button class="test-btn danger" onclick="discardTile()">ç‰Œã‚’æ¨ã¦ã‚‹</button>
            </div>

            <div class="status-info" id="drawn-status">
                <strong>çŠ¶æ…‹:</strong> ã€Œç‰Œã‚’å¼•ãã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦å¼•ã„ãŸç‰Œã®è¡¨ç¤ºã‚’ç¢ºèªã—ã¦ãã ã•ã„
            </div>
        </div>

        <div class="test-section">
            <h3>ãƒ†ã‚¹ãƒˆ3: æ¨ã¦ç‰Œå¾Œã®å†ã‚½ãƒ¼ãƒˆ</h3>
            <p>ç‰Œã‚’æ¨ã¦ãŸå¾Œã€æ®‹ã‚Šã®ç‰ŒãŒå†ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã™</p>

            <div class="demo-hand" id="discard-hand"></div>

            <div class="test-controls">
                <button class="test-btn" onclick="simulateDiscardFlow()">æ¨ã¦ç‰Œãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ</button>
                <button class="test-btn secondary" onclick="resetDiscardTest()">ãƒªã‚»ãƒƒãƒˆ</button>
            </div>

            <div class="status-info" id="discard-status">
                <strong>çŠ¶æ…‹:</strong> ã€Œæ¨ã¦ç‰Œãƒ•ãƒ­ãƒ¼å®Ÿè¡Œã€ã§ä¸€é€£ã®æµã‚Œã‚’ç¢ºèªã§ãã¾ã™
            </div>
        </div>

        <div class="test-section">
            <h3>ãƒ†ã‚¹ãƒˆ4: é‡è¤‡ç‰Œã®å‡¦ç†</h3>
            <p>å¼•ã„ãŸç‰ŒãŒæ‰‹ç‰Œã®ä¸­ã«æ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã®è¡¨ç¤ºãƒ†ã‚¹ãƒˆ</p>

            <div class="demo-hand" id="duplicate-hand"></div>

            <div class="test-controls">
                <button class="test-btn" onclick="testDuplicateTiles()">é‡è¤‡ç‰Œãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
                <button class="test-btn secondary" onclick="resetDuplicateTest()">ãƒªã‚»ãƒƒãƒˆ</button>
            </div>

            <div class="status-info" id="duplicate-status">
                <strong>çŠ¶æ…‹:</strong> ã€Œé‡è¤‡ç‰Œãƒ†ã‚¹ãƒˆå®Ÿè¡Œã€ã§é‡è¤‡ç‰Œã®å‡¦ç†ã‚’ç¢ºèªã—ã¦ãã ã•ã„
            </div>
        </div>

        <div class="test-section">
            <h3>ãƒ†ã‚¹ãƒˆ5: ãƒã‚¦ã‚¹æ“ä½œãƒ†ã‚¹ãƒˆ</h3>
            <p>ã‚·ãƒ³ã‚°ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆé¸æŠï¼‰ã¨ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆæ¨ã¦ã‚‹ï¼‰ã®å‹•ä½œç¢ºèª</p>

            <div class="demo-hand" id="mouse-test-hand"></div>

            <div class="test-controls">
                <button class="test-btn" onclick="setupMouseTest()">ãƒã‚¦ã‚¹æ“ä½œãƒ†ã‚¹ãƒˆé–‹å§‹</button>
                <button class="test-btn secondary" onclick="resetMouseTest()">ãƒªã‚»ãƒƒãƒˆ</button>
            </div>

            <div class="status-info" id="mouse-test-status">
                <strong>æ“ä½œæ–¹æ³•:</strong> ç‰Œã‚’ã‚·ãƒ³ã‚°ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆé¸æŠï¼‰ã€ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆæ¨ã¦ã‚‹ï¼‰ã—ã¦ãã ã•ã„
            </div>
        </div>

        <div class="test-section">
            <h3>ãƒ†ã‚¹ãƒˆ6: ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ç¢ºèª</h3>
            <p>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã—ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å‹•ä½œã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>

            <div class="demo-hand" id="responsive-hand"></div>

            <div class="test-controls">
                <button class="test-btn" onclick="showResponsiveTest()">ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ†ã‚¹ãƒˆè¡¨ç¤º</button>
            </div>

            <div class="status-info">
                <strong>ç¢ºèªé …ç›®:</strong> ç‰Œã‚µã‚¤ã‚ºã€åŒºåˆ‡ã‚Šç·šã€ã€Œå¼•ã€ãƒãƒ¼ã‚¯ãŒé©åˆ‡ã«ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ã“ã¨
            </div>
        </div>
    </div>

    <script>
        // å¿…è¦ãªé–¢æ•°ã‚’ã‚³ãƒ”ãƒ¼
        function getTileDisplayText(tile) {
            if (tile.suit === 'bamboo') {
                return tile.value.toString();
            } else if (tile.suit === 'honor') {
                switch (tile.value) {
                    case 'white': return 'ç™½';
                    case 'green': return 'ç™¼';
                    case 'red': return 'ä¸­';
                    default: return tile.value;
                }
            }
            return tile.value;
        }

        function sortTilesForDisplay(tiles) {
            if (!Array.isArray(tiles)) {
                return [];
            }

            const validTiles = tiles.filter(tile =>
                tile &&
                typeof tile === 'object' &&
                tile.suit &&
                tile.value !== undefined &&
                tile.value !== null
            );

            if (validTiles.length === 0) {
                return [];
            }

            return [...validTiles].sort((a, b) => {
                const getSuitPriority = (tile) => {
                    if (tile.suit === 'bamboo') return 1;
                    if (tile.suit === 'honor') return 2;
                    return 3;
                };

                const getHonorPriority = (value) => {
                    switch (value) {
                        case 'white': return 1;
                        case 'green': return 2;
                        case 'red': return 3;
                        default: return 4;
                    }
                };

                const suitPriorityA = getSuitPriority(a);
                const suitPriorityB = getSuitPriority(b);

                if (suitPriorityA !== suitPriorityB) {
                    return suitPriorityA - suitPriorityB;
                }

                if (a.suit === 'bamboo' && b.suit === 'bamboo') {
                    const valueA = parseInt(a.value) || 0;
                    const valueB = parseInt(b.value) || 0;
                    return valueA - valueB;
                }

                if (a.suit === 'honor' && b.suit === 'honor') {
                    const priorityA = getHonorPriority(a.value);
                    const priorityB = getHonorPriority(b.value);
                    return priorityA - priorityB;
                }

                return 0;
            });
        }

        function createTileElement(tile, isClickable = false) {
            const tileElement = document.createElement('div');
            tileElement.className = 'tile';

            const displayText = getTileDisplayText(tile);
            tileElement.textContent = displayText;

            if (tile.suit === 'bamboo') {
                tileElement.classList.add('bamboo');
            } else if (tile.suit === 'honor') {
                tileElement.classList.add('honor');
            }

            if (isClickable) {
                tileElement.classList.add('clickable');
                tileElement.style.cursor = 'pointer';
            }

            return tileElement;
        }

        function displayPlayerHand(tiles, isClickable = false, drawnTile = null, containerId = 'player-hand') {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            if (!Array.isArray(tiles)) {
                return;
            }

            let handTiles = [...tiles];
            let separateDrawnTile = null;

            if (drawnTile) {
                separateDrawnTile = drawnTile;
                handTiles = tiles.filter(tile => tile.id !== drawnTile.id);
            } else if (tiles.length === 5) {
                separateDrawnTile = tiles[tiles.length - 1];
                handTiles = tiles.slice(0, -1);
            }

            const sortedTiles = sortTilesForDisplay(handTiles);

            sortedTiles.forEach(tile => {
                const tileElement = createTileElement(tile, isClickable);
                tileElement.classList.add('sorted-tile');
                container.appendChild(tileElement);
            });

            if (separateDrawnTile) {
                const separator = document.createElement('div');
                separator.className = 'tile-separator';
                separator.setAttribute('aria-hidden', 'true');
                container.appendChild(separator);

                const drawnTileElement = createTileElement(separateDrawnTile, isClickable);
                drawnTileElement.classList.add('drawn-tile');
                drawnTileElement.setAttribute('aria-label', `å¼•ã„ãŸç‰Œ: ${getTileDisplayText(separateDrawnTile)}`);
                container.appendChild(drawnTileElement);
            }
        }

        // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
        let currentHand = [
            { id: 'tile-1', suit: 'honor', value: 'red' },
            { id: 'tile-2', suit: 'bamboo', value: 5 },
            { id: 'tile-3', suit: 'honor', value: 'white' },
            { id: 'tile-4', suit: 'bamboo', value: 1 }
        ];

        let drawnTileData = null;

        // ãƒ†ã‚¹ãƒˆé–¢æ•°
        function showBasicHand() {
            displayPlayerHand(currentHand, false, null, 'basic-hand');
        }

        function shuffleBasicHand() {
            const shuffled = [...currentHand].sort(() => Math.random() - 0.5);
            displayPlayerHand(shuffled, false, null, 'basic-hand');
        }

        function drawTile() {
            const newTile = { id: 'drawn-' + Date.now(), suit: 'bamboo', value: 7 };
            drawnTileData = newTile;
            const handWith5 = [...currentHand, newTile];
            displayPlayerHand(handWith5, true, newTile, 'drawn-hand');

            document.getElementById('drawn-status').innerHTML =
                '<strong>çŠ¶æ…‹:</strong> ç‰Œã€Œ7ã€ã‚’å¼•ãã¾ã—ãŸã€‚å³ç«¯ã«åŒºåˆ‡ã‚Šç·šã¨ã€Œå¼•ã€ãƒãƒ¼ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚';
        }

        function drawRandomTile() {
            const suits = ['bamboo', 'honor'];
            const bambooValues = [1, 2, 3, 4, 5, 6, 7, 8, 9];
            const honorValues = ['white', 'green', 'red'];

            const suit = suits[Math.floor(Math.random() * suits.length)];
            const value = suit === 'bamboo' ?
                bambooValues[Math.floor(Math.random() * bambooValues.length)] :
                honorValues[Math.floor(Math.random() * honorValues.length)];

            const newTile = { id: 'drawn-' + Date.now(), suit: suit, value: value };
            drawnTileData = newTile;
            const handWith5 = [...currentHand, newTile];
            displayPlayerHand(handWith5, true, newTile, 'drawn-hand');

            document.getElementById('drawn-status').innerHTML =
                `<strong>çŠ¶æ…‹:</strong> ç‰Œã€Œ${getTileDisplayText(newTile)}ã€ã‚’å¼•ãã¾ã—ãŸã€‚å³ç«¯ã«åŒºåˆ‡ã‚Šç·šã¨ã€Œå¼•ã€ãƒãƒ¼ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚`;
        }

        function discardTile() {
            if (!drawnTileData) {
                alert('å…ˆã«ç‰Œã‚’å¼•ã„ã¦ãã ã•ã„');
                return;
            }

            // å¼•ã„ãŸç‰Œã‚’æ¨ã¦ã‚‹ï¼ˆå®Ÿéš›ã®ã‚²ãƒ¼ãƒ ã§ã¯ä»»æ„ã®ç‰Œã‚’é¸æŠå¯èƒ½ï¼‰
            displayPlayerHand(currentHand, false, null, 'drawn-hand');
            drawnTileData = null;

            document.getElementById('drawn-status').innerHTML =
                '<strong>çŠ¶æ…‹:</strong> ç‰Œã‚’æ¨ã¦ã¾ã—ãŸã€‚æ®‹ã‚Šã®4æšãŒå†ã‚½ãƒ¼ãƒˆã•ã‚Œã¦è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚';
        }

        function simulateDiscardFlow() {
            const container = document.getElementById('discard-hand');
            const status = document.getElementById('discard-status');

            // ã‚¹ãƒ†ãƒƒãƒ—1: åŸºæœ¬æ‰‹ç‰Œ
            status.innerHTML = '<strong>ã‚¹ãƒ†ãƒƒãƒ—1:</strong> åŸºæœ¬æ‰‹ç‰Œï¼ˆ4æšï¼‰ã‚’è¡¨ç¤º';
            displayPlayerHand(currentHand, false, null, 'discard-hand');

            setTimeout(() => {
                // ã‚¹ãƒ†ãƒƒãƒ—2: ç‰Œã‚’å¼•ã
                status.innerHTML = '<strong>ã‚¹ãƒ†ãƒƒãƒ—2:</strong> ç‰Œã€Œ9ã€ã‚’å¼•ãã¾ã—ãŸï¼ˆå³ç«¯ã«è¡¨ç¤ºï¼‰';
                const newTile = { id: 'flow-drawn', suit: 'bamboo', value: 9 };
                const handWith5 = [...currentHand, newTile];
                displayPlayerHand(handWith5, true, newTile, 'discard-hand');

                setTimeout(() => {
                    // ã‚¹ãƒ†ãƒƒãƒ—3: ç‰Œã‚’æ¨ã¦ã‚‹
                    status.innerHTML = '<strong>ã‚¹ãƒ†ãƒƒãƒ—3:</strong> ç‰Œã€Œä¸­ã€ã‚’æ¨ã¦ã¾ã—ãŸï¼ˆæ®‹ã‚Š4æšã‚’å†ã‚½ãƒ¼ãƒˆï¼‰';
                    const afterDiscard = currentHand.filter(t => t.value !== 'red').concat([newTile]);
                    displayPlayerHand(afterDiscard, false, null, 'discard-hand');
                }, 2000);
            }, 1500);
        }

        function resetDiscardTest() {
            displayPlayerHand(currentHand, false, null, 'discard-hand');
            document.getElementById('discard-status').innerHTML =
                '<strong>çŠ¶æ…‹:</strong> ã€Œæ¨ã¦ç‰Œãƒ•ãƒ­ãƒ¼å®Ÿè¡Œã€ã§ä¸€é€£ã®æµã‚Œã‚’ç¢ºèªã§ãã¾ã™';
        }

        function testDuplicateTiles() {
            const status = document.getElementById('duplicate-status');

            // åŸºæœ¬æ‰‹ç‰Œï¼ˆ4æšï¼‰
            const baseHand = [
                { id: 'dup-1', suit: 'bamboo', value: 5 },
                { id: 'dup-2', suit: 'honor', value: 'white' },
                { id: 'dup-3', suit: 'bamboo', value: 1 },
                { id: 'dup-4', suit: 'honor', value: 'red' }
            ];

            status.innerHTML = '<strong>ã‚¹ãƒ†ãƒƒãƒ—1:</strong> åŸºæœ¬æ‰‹ç‰Œã‚’è¡¨ç¤ºï¼ˆ5, ç™½, 1, ä¸­ï¼‰';
            displayPlayerHand(baseHand, false, null, 'duplicate-hand');

            setTimeout(() => {
                // é‡è¤‡ã™ã‚‹ç‰Œã‚’å¼•ãï¼ˆ5ã‚’å¼•ãï¼‰
                const drawnDuplicate = { id: 'dup-5', suit: 'bamboo', value: 5 };
                const handWithDuplicate = [...baseHand, drawnDuplicate];

                status.innerHTML = '<strong>ã‚¹ãƒ†ãƒƒãƒ—2:</strong> æ—¢å­˜ã®ã€Œ5ã€ã¨åŒã˜ç‰Œã‚’å¼•ãã¾ã—ãŸï¼ˆé‡è¤‡ç‰Œãƒ†ã‚¹ãƒˆï¼‰';
                displayPlayerHand(handWithDuplicate, true, drawnDuplicate, 'duplicate-hand');

                setTimeout(() => {
                    status.innerHTML = '<strong>çµæœ:</strong> âœ“ åŸºæœ¬æ‰‹ç‰Œã«ã€Œ5ã€ãŒ1æšã€å¼•ã„ãŸç‰Œã¨ã—ã¦ã€Œ5ã€ãŒ1æšã€åˆè¨ˆ2æšã®ã€Œ5ã€ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™';
                }, 1500);
            }, 1500);
        }

        function resetDuplicateTest() {
            document.getElementById('duplicate-hand').innerHTML = '';
            document.getElementById('duplicate-status').innerHTML =
                '<strong>çŠ¶æ…‹:</strong> ã€Œé‡è¤‡ç‰Œãƒ†ã‚¹ãƒˆå®Ÿè¡Œã€ã§é‡è¤‡ç‰Œã®å‡¦ç†ã‚’ç¢ºèªã—ã¦ãã ã•ã„';
        }

        // ãƒã‚¦ã‚¹æ“ä½œãƒ†ã‚¹ãƒˆç”¨ã®å¤‰æ•°
        let mouseTestHand = [];
        let selectedTileForTest = null;

        function setupMouseTest() {
            mouseTestHand = [
                { id: 'mouse-1', suit: 'bamboo', value: 3 },
                { id: 'mouse-2', suit: 'honor', value: 'white' },
                { id: 'mouse-3', suit: 'bamboo', value: 7 },
                { id: 'mouse-4', suit: 'honor', value: 'red' },
                { id: 'mouse-5', suit: 'bamboo', value: 9 }
            ];

            displayMouseTestHand();

            document.getElementById('mouse-test-status').innerHTML =
                '<strong>ãƒ†ã‚¹ãƒˆé–‹å§‹:</strong> ç‰Œã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆé¸æŠï¼‰ã¾ãŸã¯ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆæ¨ã¦ã‚‹ï¼‰ã—ã¦ãã ã•ã„';
        }

        function displayMouseTestHand() {
            const container = document.getElementById('mouse-test-hand');
            container.innerHTML = '';

            const drawnTile = mouseTestHand.length === 5 ? mouseTestHand[mouseTestHand.length - 1] : null;

            // ã‚½ãƒ¼ãƒˆæ¸ˆã¿æ‰‹ç‰Œã‚’è¡¨ç¤º
            let handTiles = drawnTile ? mouseTestHand.slice(0, -1) : mouseTestHand;
            const sortedTiles = sortTilesForDisplay(handTiles);

            sortedTiles.forEach(tile => {
                const tileElement = createTileElement(tile, true);
                tileElement.classList.add('sorted-tile');

                // ãƒ†ã‚¹ãƒˆç”¨ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¿½åŠ 
                tileElement.addEventListener('click', (e) => {
                    e.preventDefault();
                    handleMouseTestClick(tile, tileElement);
                });

                tileElement.addEventListener('dblclick', (e) => {
                    e.preventDefault();
                    handleMouseTestDoubleClick(tile, tileElement);
                });

                container.appendChild(tileElement);
            });

            // å¼•ã„ãŸç‰ŒãŒã‚ã‚‹å ´åˆ
            if (drawnTile) {
                const separator = document.createElement('div');
                separator.className = 'tile-separator';
                container.appendChild(separator);

                const drawnTileElement = createTileElement(drawnTile, true);
                drawnTileElement.classList.add('drawn-tile');

                drawnTileElement.addEventListener('click', (e) => {
                    e.preventDefault();
                    handleMouseTestClick(drawnTile, drawnTileElement);
                });

                drawnTileElement.addEventListener('dblclick', (e) => {
                    e.preventDefault();
                    handleMouseTestDoubleClick(drawnTile, drawnTileElement);
                });

                container.appendChild(drawnTileElement);
            }
        }

        function handleMouseTestClick(tile, tileElement) {
            // æ—¢å­˜ã®é¸æŠã‚’è§£é™¤
            const previousSelected = document.querySelector('#mouse-test-hand .tile.selected');
            if (previousSelected) {
                previousSelected.classList.remove('selected');
            }

            // æ–°ã—ã„ç‰Œã‚’é¸æŠ
            selectedTileForTest = tile;
            tileElement.classList.add('selected');

            document.getElementById('mouse-test-status').innerHTML =
                `<strong>é¸æŠ:</strong> ç‰Œã€Œ${getTileDisplayText(tile)}ã€ã‚’é¸æŠã—ã¾ã—ãŸã€‚ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§æ¨ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚`;
        }

        function handleMouseTestDoubleClick(tile, tileElement) {
            // é¸æŠçŠ¶æ…‹ã«ã™ã‚‹
            const previousSelected = document.querySelector('#mouse-test-hand .tile.selected');
            if (previousSelected) {
                previousSelected.classList.remove('selected');
            }

            selectedTileForTest = tile;
            tileElement.classList.add('selected');
            tileElement.classList.add('double-clicked');

            document.getElementById('mouse-test-status').innerHTML =
                `<strong>æ¨ã¦ç‰Œ:</strong> ç‰Œã€Œ${getTileDisplayText(tile)}ã€ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§æ¨ã¦ã¾ã—ãŸï¼`;

            // ç‰Œã‚’æ‰‹ç‰Œã‹ã‚‰é™¤å»
            setTimeout(() => {
                mouseTestHand = mouseTestHand.filter(t => t.id !== tile.id);
                displayMouseTestHand();

                if (mouseTestHand.length === 0) {
                    document.getElementById('mouse-test-status').innerHTML =
                        '<strong>å®Œäº†:</strong> âœ“ ã™ã¹ã¦ã®ç‰Œã‚’æ¨ã¦ã¾ã—ãŸã€‚ãƒã‚¦ã‚¹æ“ä½œãƒ†ã‚¹ãƒˆæˆåŠŸï¼';
                } else {
                    document.getElementById('mouse-test-status').innerHTML =
                        `<strong>ç¶™ç¶š:</strong> æ®‹ã‚Š${mouseTestHand.length}æšã€‚å¼•ãç¶šããƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚`;
                }
            }, 300);
        }

        function resetMouseTest() {
            document.getElementById('mouse-test-hand').innerHTML = '';
            selectedTileForTest = null;
            document.getElementById('mouse-test-status').innerHTML =
                '<strong>æ“ä½œæ–¹æ³•:</strong> ç‰Œã‚’ã‚·ãƒ³ã‚°ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆé¸æŠï¼‰ã€ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ï¼ˆæ¨ã¦ã‚‹ï¼‰ã—ã¦ãã ã•ã„';
        }

        function showResponsiveTest() {
            const testHand = [
                { id: 'resp-1', suit: 'bamboo', value: 1 },
                { id: 'resp-2', suit: 'bamboo', value: 5 },
                { id: 'resp-3', suit: 'honor', value: 'white' },
                { id: 'resp-4', suit: 'honor', value: 'green' },
                { id: 'resp-5', suit: 'bamboo', value: 9 }
            ];

            const drawnTile = testHand[testHand.length - 1];
            displayPlayerHand(testHand, true, drawnTile, 'responsive-hand');
        }

        // åˆæœŸåŒ–
        window.onload = function () {
            showBasicHand();
            showResponsiveTest();
        };
    </script>
</body>

</html>